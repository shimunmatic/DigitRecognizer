import keras
import numpy as np
import cv2
from PIL import Image
from io import StringIO
import base64
from binascii import a2b_base64

#load pretrained model
model = keras.models.load_model("mnist_cnn_model.h5")

def data_uri_to_cv2_img(uri):
        encoded_data = uri.split(',')[1]
        # print("ƒç")
        # img = base64.b64decode(uri)
        # nparr = np.fromstring(img, np.uint8)
        # img_np = cv2.imdecode(nparr, cv2.IMREAD_COLOR)  # cv2.IMREAD_COLOR in OpenCV 3.1
        data = encoded_data
        binary_data = a2b_base64(data)

        fd = open('imagelol.png', 'wb')
        fd.write(binary_data)
        fd.close()

        return cv2.imread('imagelol.png')

def add_border_to_image(im):
    WHITE = [255,255,255]

    bordersize = 100
    border = cv2.copyMakeBorder(im, top=bordersize, bottom=bordersize, left=bordersize, right=bordersize,
                                borderType=cv2.BORDER_CONSTANT, value=WHITE)
    return border



def cnn_predict(im):
    im = cv2.resize(im,(28,28))
    im=im/255
    predictedImage = np.resize(im,(1,28,28,1))
    prediction = model.predict_classes(predictedImage)
    return prediction


# Read the input image
im = data_uri_to_cv2_img("data:image/png;base64,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")
cv2.imwrite("base.png", im)

im = add_border_to_image(im)
im = cv2.resize(im,(500,500))
# Convert to grayscale and apply Gaussian filtering

# cv2.imwrite("base.png", im)

im_gray = cv2.cvtColor(im, cv2.COLOR_BGR2GRAY)
im_gray = cv2.GaussianBlur(im_gray, (5, 5), 0)

# Threshold the image
ret, im_th = cv2.threshold(im_gray, 90, 255, cv2.THRESH_BINARY_INV)

# Find contours in the image
_,ctrs, hier = cv2.findContours(im_th.copy(), cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)

# Get rectangles contains each contour
rects = [cv2.boundingRect(ctr) for ctr in ctrs]

# For each rectangular region, calculate HOG features and predict
# the digit using Linear SVM.
cnt=0
print(len(rects))
for rect in rects:
    cnt+=1
    print(rect)
    # Draw the rectangles

    cv2.rectangle(im, (rect[0], rect[1]), (rect[0] + rect[2], rect[1] + rect[3]), (0, 255, 0), 3)
    leng = int(rect[3]*1.4)
    pt1 = int(rect[1] + rect[3] // 2 - leng // 2)
    pt2 = int(rect[0] + rect[2] // 2 - leng // 2)
    roi = im_th[pt1:pt1 + leng, pt2:pt2 + leng]    # Make the rectangular region around the digit
    # Resize the image
   # roi = im_th[rect[1]:rect[1]+rect[3],rect[0]:rect[0]+rect[2]]
   # currim = im[y:y + h, x:x + w]
    print(roi.shape)
    x,y= roi.shape
    #if( x>= 28 & y>= 28):
    roi = cv2.resize(roi, (28, 28), interpolation=cv2.INTER_AREA)
    roi = cv2.dilate(roi, (3, 3))
    cv2.imwrite("im"+cnt.__str__()+".jpg",roi)
    #predict rectangle
    nbr = cnn_predict(roi)
    cv2.putText(im, str(int(nbr[0])), (rect[0], rect[1]),cv2.FONT_HERSHEY_DUPLEX, 2, (0, 255, 255), 3)


cv2.imwrite("read_photo.jpg",im)
img = Image.open("read_photo.jpg")
img.show()



